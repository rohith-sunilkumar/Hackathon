#!/usr/bin/env python3
"""
Script to create a PowerPoint presentation about the Smart City Citizen Portal tools
"""

try:
    from pptx import Presentation
    from pptx.util import Inches, Pt
    from pptx.enum.text import PP_ALIGN
    from pptx.dml.color import RGBColor
except ImportError:
    print("Installing python-pptx...")
    import subprocess
    subprocess.check_call(['pip3', 'install', 'python-pptx'])
    from pptx import Presentation
    from pptx.util import Inches, Pt
    from pptx.enum.text import PP_ALIGN
    from pptx.dml.color import RGBColor

def create_title_slide(prs, title, subtitle):
    """Create a title slide"""
    slide = prs.slides.add_slide(prs.slide_layouts[0])
    title_shape = slide.shapes.title
    subtitle_shape = slide.placeholders[1]
    
    title_shape.text = title
    subtitle_shape.text = subtitle
    
    return slide

def create_content_slide(prs, title, content_items):
    """Create a content slide with bullet points"""
    slide = prs.slides.add_slide(prs.slide_layouts[1])
    title_shape = slide.shapes.title
    body_shape = slide.placeholders[1]
    
    title_shape.text = title
    
    tf = body_shape.text_frame
    tf.clear()
    
    for item in content_items:
        p = tf.add_paragraph()
        p.text = item
        p.level = 0
        p.font.size = Pt(18)
    
    return slide

def create_two_column_slide(prs, title, left_items, right_items):
    """Create a slide with two columns"""
    slide = prs.slides.add_slide(prs.slide_layouts[1])
    title_shape = slide.shapes.title
    title_shape.text = title
    
    # Left column
    left = slide.shapes.add_textbox(Inches(0.5), Inches(1.5), Inches(4.5), Inches(5))
    tf_left = left.text_frame
    for item in left_items:
        p = tf_left.add_paragraph()
        p.text = item
        p.font.size = Pt(16)
    
    # Right column
    right = slide.shapes.add_textbox(Inches(5.2), Inches(1.5), Inches(4.5), Inches(5))
    tf_right = right.text_frame
    for item in right_items:
        p = tf_right.add_paragraph()
        p.text = item
        p.font.size = Pt(16)
    
    return slide

def main():
    prs = Presentation()
    prs.slide_width = Inches(10)
    prs.slide_height = Inches(7.5)
    
    # Slide 1: Title
    create_title_slide(prs, 
        "Smart City Citizen Portal",
        "Technology Stack & Development Tools\n\nAn AI-Powered Civic Engagement Platform")
    
    # Slide 2: Project Overview
    create_content_slide(prs, "Project Overview", [
        "Full-Stack Web Application for civic issue reporting",
        "AI-Powered automatic complaint categorization",
        "Real-Time Analytics dashboard for administrators",
        "Responsive Design for all devices",
        "",
        "üìä Statistics:",
        "‚Ä¢ 30+ Files",
        "‚Ä¢ 3,500+ Lines of Code",
        "‚Ä¢ 10+ API Endpoints",
        "‚Ä¢ 8 Major Features"
    ])
    
    # Slide 3: MERN Stack
    create_content_slide(prs, "MERN Stack Architecture", [
        "M - MongoDB: NoSQL Database",
        "E - Express.js: Web Framework",
        "R - React: Frontend Library",
        "N - Node.js: JavaScript Runtime",
        "",
        "‚úÖ JavaScript Everywhere",
        "‚úÖ Modern & Scalable",
        "‚úÖ Large Community Support",
        "‚úÖ Production Ready"
    ])
    
    # Slide 4: Frontend Technologies
    create_content_slide(prs, "Frontend Technologies", [
        "‚öõÔ∏è React 18 - UI Library",
        "   ‚Ä¢ Component-based architecture",
        "   ‚Ä¢ Hooks & Context API",
        "   ‚Ä¢ Efficient rendering",
        "",
        "üé® Tailwind CSS - Styling Framework",
        "   ‚Ä¢ Utility-first approach",
        "   ‚Ä¢ Responsive design",
        "   ‚Ä¢ Custom theme support",
        "",
        "üöÄ Vite - Build Tool",
        "   ‚Ä¢ Lightning-fast HMR",
        "   ‚Ä¢ Optimized production builds"
    ])
    
    # Slide 5: Frontend Libraries
    create_content_slide(prs, "Frontend Libraries", [
        "üß≠ React Router v6 - Client-side routing",
        "   ‚Ä¢ Protected routes",
        "   ‚Ä¢ Nested routing",
        "",
        "üì° Axios - HTTP Client",
        "   ‚Ä¢ Request/response interceptors",
        "   ‚Ä¢ Error handling",
        "",
        "üìä Recharts - Data Visualization",
        "   ‚Ä¢ Pie, Bar, Line charts",
        "   ‚Ä¢ Interactive tooltips",
        "",
        "üéØ Lucide React - Modern icon library"
    ])
    
    # Slide 6: Backend Technologies
    create_content_slide(prs, "Backend Technologies", [
        "üü¢ Node.js v20 - JavaScript Runtime",
        "   ‚Ä¢ Fast & scalable",
        "   ‚Ä¢ Event-driven architecture",
        "   ‚Ä¢ ES Modules support",
        "",
        "‚ö° Express.js - Web Framework",
        "   ‚Ä¢ Minimal & flexible",
        "   ‚Ä¢ Robust middleware support",
        "   ‚Ä¢ RESTful API design",
        "",
        "üì¶ npm - Package Manager",
        "   ‚Ä¢ 182 backend dependencies",
        "   ‚Ä¢ 462 frontend dependencies"
    ])
    
    # Slide 7: Database
    create_content_slide(prs, "Database Technology", [
        "üçÉ MongoDB - NoSQL Database",
        "   ‚Ä¢ Flexible schema",
        "   ‚Ä¢ JSON-like documents",
        "   ‚Ä¢ Geospatial indexing",
        "   ‚Ä¢ Aggregation pipelines",
        "",
        "üîß Mongoose ODM",
        "   ‚Ä¢ Schema validation",
        "   ‚Ä¢ Middleware hooks",
        "   ‚Ä¢ Query building",
        "   ‚Ä¢ Population (joins)",
        "",
        "üìç Geospatial Features",
        "   ‚Ä¢ 2dsphere indexing for location queries"
    ])
    
    # Slide 8: AI Integration
    create_content_slide(prs, "AI & Machine Learning", [
        "ü§ñ OpenAI API (GPT-4 Turbo)",
        "",
        "Capabilities:",
        "‚Ä¢ Automatic categorization (6 categories)",
        "‚Ä¢ Priority assignment (high/medium/low)",
        "‚Ä¢ Confidence scoring (80-95% accuracy)",
        "‚Ä¢ Reasoning explanation",
        "",
        "Categories:",
        "Road, Lighting, Waste, Safety, Water, Other",
        "",
        "‚úÖ Fallback system if AI unavailable"
    ])
    
    # Slide 9: Authentication & Security
    create_content_slide(prs, "Authentication & Security", [
        "üîê JSON Web Tokens (JWT)",
        "   ‚Ä¢ Stateless authentication",
        "   ‚Ä¢ Token expiration handling",
        "",
        "üîí Bcrypt.js",
        "   ‚Ä¢ Password hashing",
        "   ‚Ä¢ Salt rounds for security",
        "",
        "üõ°Ô∏è Security Features:",
        "   ‚Ä¢ CORS configuration",
        "   ‚Ä¢ Input validation (express-validator)",
        "   ‚Ä¢ Role-based access control",
        "   ‚Ä¢ XSS protection"
    ])
    
    # Slide 10: File Upload
    create_content_slide(prs, "File Upload & Storage", [
        "üì§ Multer - File Upload Middleware",
        "   ‚Ä¢ Multi-file upload (up to 5 images)",
        "   ‚Ä¢ File type validation",
        "   ‚Ä¢ Size limits (5MB per file)",
        "   ‚Ä¢ Disk storage",
        "",
        "‚òÅÔ∏è Cloudinary (Optional)",
        "   ‚Ä¢ Cloud image storage",
        "   ‚Ä¢ Image optimization",
        "   ‚Ä¢ CDN delivery",
        "",
        "üíæ Local Storage Alternative",
        "   ‚Ä¢ Uploads directory",
        "   ‚Ä¢ Static file serving"
    ])
    
    # Slide 11: Development Tools
    create_content_slide(prs, "Development Tools", [
        "üîÑ Nodemon - Auto-restart server",
        "   ‚Ä¢ Watch for file changes",
        "   ‚Ä¢ Faster development workflow",
        "",
        "üìù dotenv - Environment variables",
        "   ‚Ä¢ Secure configuration",
        "   ‚Ä¢ Keep secrets out of code",
        "",
        "‚úÖ ESLint - Code linting",
        "   ‚Ä¢ Code consistency",
        "   ‚Ä¢ Error prevention",
        "",
        "üéØ ES Modules - Modern JavaScript",
        "   ‚Ä¢ Better tree-shaking",
        "   ‚Ä¢ Cleaner imports"
    ])
    
    # Slide 12: API Architecture
    create_content_slide(prs, "RESTful API Design", [
        "üì° API Endpoints (10+):",
        "",
        "Authentication:",
        "‚Ä¢ POST /api/auth/register",
        "‚Ä¢ POST /api/auth/login",
        "‚Ä¢ GET /api/auth/me",
        "",
        "Reports:",
        "‚Ä¢ POST /api/reports (with AI classification)",
        "‚Ä¢ GET /api/reports (with filters)",
        "‚Ä¢ GET /api/reports/:id",
        "‚Ä¢ PATCH /api/reports/:id (admin)",
        "‚Ä¢ DELETE /api/reports/:id (admin)",
        "",
        "Analytics:",
        "‚Ä¢ GET /api/stats (admin dashboard)"
    ])
    
    # Slide 13: State Management
    create_content_slide(prs, "State Management", [
        "‚öõÔ∏è React Context API",
        "   ‚Ä¢ Global state management",
        "   ‚Ä¢ AuthContext for user state",
        "   ‚Ä¢ No external library needed",
        "",
        "üîÑ React Hooks",
        "   ‚Ä¢ useState - Component state",
        "   ‚Ä¢ useEffect - Side effects",
        "   ‚Ä¢ useNavigate - Routing",
        "   ‚Ä¢ useParams - URL parameters",
        "",
        "Benefits:",
        "   ‚Ä¢ Simple API",
        "   ‚Ä¢ Built into React",
        "   ‚Ä¢ Lightweight solution"
    ])
    
    # Slide 14: Data Visualization
    create_content_slide(prs, "Data Visualization with Recharts", [
        "üìä Charts Implemented:",
        "",
        "1. Pie Chart - Category distribution",
        "   ‚Ä¢ Visual breakdown of report types",
        "",
        "2. Bar Chart - Status breakdown",
        "   ‚Ä¢ Open, In-Progress, Resolved counts",
        "",
        "3. Line Chart - 30-day trend",
        "   ‚Ä¢ Historical report patterns",
        "",
        "Features:",
        "‚Ä¢ Responsive design",
        "‚Ä¢ Interactive tooltips",
        "‚Ä¢ Custom colors",
        "‚Ä¢ Legend support"
    ])
    
    # Slide 15: Responsive Design
    create_content_slide(prs, "Responsive Design", [
        "üì± Mobile-First Approach",
        "",
        "Breakpoints:",
        "‚Ä¢ Mobile: < 640px",
        "‚Ä¢ Tablet: 640px - 1024px",
        "‚Ä¢ Desktop: > 1024px",
        "",
        "Tailwind CSS Features:",
        "‚Ä¢ Utility classes for responsiveness",
        "‚Ä¢ Custom color palette",
        "‚Ä¢ Consistent spacing scale",
        "‚Ä¢ Typography system",
        "",
        "‚úÖ Works on all devices",
        "‚úÖ Touch-friendly interface"
    ])
    
    # Slide 16: Database Seeding
    create_content_slide(prs, "Database Seeding", [
        "üå± Custom Seed Script",
        "",
        "Creates Demo Data:",
        "‚Ä¢ 2 demo users (citizen + admin)",
        "‚Ä¢ 8 sample reports",
        "‚Ä¢ Various statuses and categories",
        "‚Ä¢ Realistic civic complaints",
        "‚Ä¢ Time-distributed data",
        "",
        "Demo Credentials:",
        "‚Ä¢ Citizen: citizen@demo.com / password",
        "‚Ä¢ Admin: admin@demo.com / password",
        "",
        "Command: npm run seed"
    ])
    
    # Slide 17: Middleware Stack
    create_content_slide(prs, "Express Middleware Stack", [
        "üîß Middleware Layers:",
        "",
        "1. CORS - Cross-origin requests",
        "2. Body Parser - JSON parsing",
        "3. Static Files - Serve uploads",
        "4. Request Logger - Track requests",
        "5. Auth Middleware - JWT verification",
        "6. Validation - Input sanitization",
        "7. Error Handler - Global error handling",
        "",
        "Benefits:",
        "‚Ä¢ Modular architecture",
        "‚Ä¢ Reusable components",
        "‚Ä¢ Clean separation of concerns"
    ])
    
    # Slide 18: Environment Configuration
    create_content_slide(prs, "Environment Configuration", [
        "‚öôÔ∏è Backend (.env):",
        "‚Ä¢ PORT=5000",
        "‚Ä¢ MONGODB_URI=mongodb://...",
        "‚Ä¢ JWT_SECRET=secret_key",
        "‚Ä¢ OPENAI_API_KEY=sk-...",
        "‚Ä¢ NODE_ENV=development",
        "",
        "üåê Frontend (.env):",
        "‚Ä¢ VITE_API_URL=http://localhost:5000/api",
        "",
        "üîí Security:",
        "‚Ä¢ .gitignore for sensitive files",
        "‚Ä¢ .env.example templates",
        "‚Ä¢ No secrets in code"
    ])
    
    # Slide 19: Deployment Tools
    create_content_slide(prs, "Deployment Platforms", [
        "üöÄ Backend Hosting:",
        "‚Ä¢ Render (recommended)",
        "‚Ä¢ Railway",
        "‚Ä¢ Heroku",
        "‚Ä¢ AWS/Azure/GCP",
        "",
        "üåê Frontend Hosting:",
        "‚Ä¢ Vercel (recommended)",
        "‚Ä¢ Netlify",
        "‚Ä¢ GitHub Pages",
        "‚Ä¢ Cloudflare Pages",
        "",
        "üíæ Database:",
        "‚Ä¢ MongoDB Atlas (cloud)",
        "‚Ä¢ Local MongoDB (development)"
    ])
    
    # Slide 20: Documentation
    create_content_slide(prs, "Comprehensive Documentation", [
        "üìö 8 Documentation Files:",
        "",
        "1. START_HERE.md - Navigation guide",
        "2. GETTING_STARTED.md - Quick start (10 min)",
        "3. README.md - Complete documentation",
        "4. SETUP.md - Detailed installation",
        "5. STRUCTURE.md - Code organization",
        "6. FEATURES.md - Feature list",
        "7. DEPLOYMENT.md - Production guide",
        "8. PROJECT_SUMMARY.md - Technical overview",
        "",
        "Total: 15,000+ words of documentation"
    ])
    
    # Slide 21: Key Features Summary
    create_content_slide(prs, "Key Features Implemented", [
        "‚úÖ User Authentication (JWT)",
        "‚úÖ AI-Powered Classification (OpenAI GPT-4)",
        "‚úÖ Image Upload (up to 5 per report)",
        "‚úÖ Location Tracking (GPS + manual)",
        "‚úÖ Admin Dashboard with Analytics",
        "‚úÖ Real-time Status Tracking",
        "‚úÖ Responsive Design",
        "‚úÖ Role-Based Access Control",
        "‚úÖ Data Visualization (Charts)",
        "‚úÖ RESTful API",
        "‚úÖ Database Seeding",
        "‚úÖ Comprehensive Documentation"
    ])
    
    # Slide 22: Why These Tools?
    create_content_slide(prs, "Tool Selection Criteria", [
        "‚úÖ Modern & Popular",
        "   ‚Ä¢ Active development",
        "   ‚Ä¢ Large community",
        "   ‚Ä¢ Good documentation",
        "",
        "‚ö° Performance",
        "   ‚Ä¢ Fast build times",
        "   ‚Ä¢ Efficient runtime",
        "   ‚Ä¢ Optimized output",
        "",
        "üë®‚Äçüíª Developer Experience",
        "   ‚Ä¢ Easy to learn",
        "   ‚Ä¢ Good tooling",
        "   ‚Ä¢ Clear APIs",
        "",
        "üöÄ Production Ready",
        "   ‚Ä¢ Battle-tested",
        "   ‚Ä¢ Secure",
        "   ‚Ä¢ Scalable"
    ])
    
    # Slide 23: Learning Outcomes
    create_content_slide(prs, "Skills & Learning Outcomes", [
        "üéì Full-Stack Development:",
        "‚Ä¢ MERN stack mastery",
        "‚Ä¢ RESTful API design",
        "‚Ä¢ Database modeling",
        "",
        "ü§ñ AI Integration:",
        "‚Ä¢ OpenAI API usage",
        "‚Ä¢ Prompt engineering",
        "‚Ä¢ Fallback strategies",
        "",
        "üé® Modern Web Development:",
        "‚Ä¢ React hooks & context",
        "‚Ä¢ Tailwind CSS",
        "‚Ä¢ ES6+ JavaScript",
        "",
        "üöÄ DevOps Basics:",
        "‚Ä¢ Environment configuration",
        "‚Ä¢ Deployment strategies"
    ])
    
    # Slide 24: Project Statistics
    create_two_column_slide(prs, "Project Statistics",
        [
            "üìä Backend:",
            "‚Ä¢ Files: 15",
            "‚Ä¢ Lines: ~1,500",
            "‚Ä¢ Functions: 30+",
            "‚Ä¢ Routes: 10+",
            "‚Ä¢ Models: 2",
            "",
            "üì¶ Dependencies:",
            "‚Ä¢ Backend: 182 packages",
            "‚Ä¢ Frontend: 462 packages"
        ],
        [
            "üìä Frontend:",
            "‚Ä¢ Files: 15",
            "‚Ä¢ Lines: ~2,000",
            "‚Ä¢ Components: 10+",
            "‚Ä¢ Pages: 8",
            "",
            "üìö Documentation:",
            "‚Ä¢ Guides: 8",
            "‚Ä¢ Words: 15,000+",
            "‚Ä¢ Examples: 50+"
        ])
    
    # Slide 25: Development Timeline
    create_content_slide(prs, "Development Timeline", [
        "‚è±Ô∏è Hackathon Breakdown:",
        "",
        "Day 1 (8 hours):",
        "‚Ä¢ Backend setup & database models",
        "‚Ä¢ API routes & AI integration",
        "",
        "Day 2 (8 hours):",
        "‚Ä¢ Frontend setup & React components",
        "‚Ä¢ Form handling & authentication",
        "",
        "Day 3 (8 hours):",
        "‚Ä¢ Admin dashboard & analytics",
        "‚Ä¢ Testing, debugging & documentation",
        "",
        "Total: ~24 hours of development"
    ])
    
    # Slide 26: Future Enhancements
    create_content_slide(prs, "Future Enhancements & Tools", [
        "üîÆ Planned Additions:",
        "",
        "Real-Time Features:",
        "‚Ä¢ Socket.io for notifications",
        "‚Ä¢ WebSockets for chat",
        "",
        "Testing:",
        "‚Ä¢ Jest for unit tests",
        "‚Ä¢ Cypress for E2E tests",
        "",
        "Monitoring:",
        "‚Ä¢ Sentry for error tracking",
        "‚Ä¢ Google Analytics",
        "",
        "Maps:",
        "‚Ä¢ Mapbox GL JS",
        "‚Ä¢ Interactive map visualization"
    ])
    
    # Slide 27: Best Practices
    create_content_slide(prs, "Best Practices Implemented", [
        "‚úÖ Code Quality:",
        "‚Ä¢ Modular architecture",
        "‚Ä¢ Separation of concerns",
        "‚Ä¢ DRY principle",
        "‚Ä¢ Clear naming conventions",
        "",
        "üîí Security:",
        "‚Ä¢ Environment variables",
        "‚Ä¢ Input validation",
        "‚Ä¢ Password hashing",
        "‚Ä¢ JWT authentication",
        "",
        "üìö Documentation:",
        "‚Ä¢ Code comments",
        "‚Ä¢ README files",
        "‚Ä¢ API documentation"
    ])
    
    # Slide 28: Conclusion
    create_content_slide(prs, "Technology Stack Summary", [
        "üéØ Complete Stack:",
        "",
        "Frontend:",
        "‚Ä¢ React + Tailwind CSS + Vite",
        "",
        "Backend:",
        "‚Ä¢ Node.js + Express + MongoDB",
        "",
        "AI:",
        "‚Ä¢ OpenAI GPT-4",
        "",
        "Tools:",
        "‚Ä¢ 20+ libraries & frameworks",
        "‚Ä¢ Modern development practices",
        "‚Ä¢ Production-ready architecture",
        "",
        "‚úÖ Ready for deployment!"
    ])
    
    # Slide 29: Thank You
    slide = prs.slides.add_slide(prs.slide_layouts[0])
    title_shape = slide.shapes.title
    subtitle_shape = slide.placeholders[1]
    
    title_shape.text = "Thank You!"
    subtitle_shape.text = "Smart City Citizen Portal\n\nBuilding Better Cities with Modern Technology\n\nüìß Questions?\nüåê GitHub: [Your Repository]\nüìö Documentation: 8 comprehensive guides"
    
    # Save presentation
    output_file = "Smart_City_Portal_Tools_Presentation.pptx"
    prs.save(output_file)
    print(f"‚úÖ Presentation created successfully: {output_file}")
    print(f"üìä Total slides: {len(prs.slides)}")

if __name__ == "__main__":
    main()
